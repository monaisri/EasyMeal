<!DOCTYPE html>
<html lang="th">
<head>
┬а <meta charset="utf-8" />
┬а <meta name="viewport" content="width=device-width,initial-scale=1" />
┬а <title>р╕Кр╕│р╕гр╕░р╣Ар╕Зр╕┤р╕Щ - EasyMeal</title>
┬а <link rel="stylesheet" href="style.css" />
</head>
<body>

┬а <header class="topbar">
┬а ┬а <div class="brand">EasyMeal</div>
┬а ┬а <div class="top-actions">
┬а ┬а ┬а <button class="btn small" onclick="location.href='menu.html'">р╕вр╣Йр╕нр╕Щр╕Бр╕ер╕▒р╕Ъ</button>
┬а ┬а ┬а <button class="btn small" onclick="location.href='index.html'">р╕лр╕Щр╣Йр╕▓р╕лр╕ер╕▒р╕Б</button>
┬а ┬а </div>
┬а </header>

┬а <main class="wide-container">
┬а ┬а <h2>р╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Бр╕▓р╕гр╕Кр╕│р╕гр╕░</h2>
┬а ┬а <div id="summaryBox"></div>

┬а ┬а <p>р╣Ар╕ер╕╖р╕нр╕Бр╕зр╕┤р╕Шр╕╡р╕Кр╕│р╕гр╕░р╣Ар╕Зр╕┤р╕Щ:</p>
┬а ┬а <label class="tick"><input type="checkbox" id="payQR" onchange="togglePay('qr')"> р╕Кр╕│р╕гр╕░р╕Фр╣Йр╕зр╕в QR</label>
┬а ┬а <label class="tick"><input type="checkbox" id="payCash" onchange="togglePay('cash')"> р╕Кр╕│р╕гр╕░р╣Ар╕Зр╕┤р╕Щр╕кр╕Фр╕Чр╕╡р╣Ир╣Ар╕Др╕▓р╕Щр╣Мр╣Ар╕Хр╕нр╕гр╣М</label>

┬а ┬а <button class="btn" style="margin-top:14px" onclick="confirmPayment()">р╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Бр╕▓р╕гр╕Кр╕│р╕гр╕░р╣Ар╕Зр╕┤р╕Щ</button>

┬а </main>

<script>
const draft = JSON.parse(localStorage.getItem('orderDraft') || 'null');
if(!draft){
┬а alert("р╣Др╕бр╣Ир╕Юр╕Ър╕Др╕│р╕кр╕▒р╣Ир╕Зр╕Лр╕╖р╣Йр╕н р╕Бр╕гр╕╕р╕Ур╕▓р╕Бр╕ер╕▒р╕Ър╣Др╕Ыр╣Ар╕ер╕╖р╕нр╕Бр╣Ар╕бр╕Щр╕╣");
┬а location.href = "menu.html";
}

// ЁЯМЯ р╕Ыр╕гр╕▒р╕Ър╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╣Ар╕бр╕Щр╕╣р╣Гр╕лр╣Йр╣Гр╕Кр╣Йр╕Кр╕╖р╣Ир╕нр╣Ар╕бр╕Щр╕╣р╣Ар╕Ыр╣Зр╕Щ Key (р╣Ар╕лр╕бр╕╖р╕нр╕Щр╣Гр╕Щ menu.html)
const menus = {
  somtum: {
    'р╕Хр╕│р╣Др╕Чр╕в': { price: 50 }, 
    'р╕Хр╕│р╕Ыр╕╣р╕Ыр╕ер╕▓р╕гр╣Йр╕▓': { price: 60 }, 
    'р╕Др╕нр╕лр╕бр╕╣р╕вр╣Ир╕▓р╕З': { price: 70 }, 
    'р╕Вр╣Йр╕▓р╕зр╣Ар╕лр╕Щр╕╡р╕вр╕з': { price: 10 }
  },
  tamsang: {
    'р╕Вр╣Йр╕▓р╕зр╕Ьр╕▒р╕Фр╕Бр╕░р╣Ар╕Юр╕гр╕▓р╕лр╕бр╕╣р╕Бр╕гр╕нр╕Ъ': { price: 55 }, 
    'р╕Вр╣Йр╕▓р╕зр╕Ьр╕▒р╕Фр╕лр╕бр╕╣р╕кр╕▒р╕Ъ': { price: 50 }, 
    'р╕Ьр╕▒р╕Фр╕Лр╕╡р╕нр╕┤р╣Кр╕зр╕лр╕бр╕╣': { price: 55 }, 
    'р╕Ьр╕▒р╕Фр╕бр╕▓р╕бр╣Ир╕▓': { price: 50 }, 
    'р╣Др╕Вр╣Ир╕Фр╕▓р╕з': { price: 10 }
  },
  noodle: {
    'р╕Ър╕░р╕лр╕бр╕╡р╣Ир╕Щр╣Йр╕│р╕лр╕бр╕╣р╣Бр╕Фр╕З': { price: 50 }, 
    'р╣Ар╕вр╣Зр╕Щр╕Хр╕▓р╣Вр╕Я': { price: 60 }, 
    'р╕Бр╣Лр╕зр╕вр╣Ар╕Хр╕╡р╣Лр╕вр╕зр╣Ар╕гр╕╖р╕н': { price: 55 }, 
    'р╣Ар╕Бр╕▓р╣Ар╕лр╕ер╕▓': { price: 60 }
  },
  friedchicken: {
    'р╕Щр╣Ир╕нр╕Зр╣Др╕Бр╣Ир╕Чр╕нр╕Ф 2 р╕Кр╕┤р╣Йр╕Щ': { price: 40 }, 
    'р╕Щр╕▒р╕Бр╣Ар╕Бр╣Зр╕Хр╣Др╕Бр╣И': { price: 55 }, 
    'р╕Ыр╕╡р╕Бр╣Др╕Бр╣Ир╕Чр╕нр╕Ф': { price: 25 },
    'р╕Вр╣Йр╕▓р╕зр╣Ар╕лр╕Щр╕╡р╕вр╕з': { price: 10 }
  },
  dessert: {
    'р╕Ър╕┤р╕Зр╕Лр╕╣ р╕Щр╕бр╕кр╕Ф': { price: 70 }, 
    'р╕Ър╕┤р╕Зр╕Лр╕╣ р╣Вр╕нр╕зр╕▒р╕ер╕Хр╕┤р╕Щ': { price: 70 }, 
    'р╕Ър╕┤р╕Зр╕Лр╕╣ р╕бр╕▒р╕Ир╕Йр╕░': { price: 70 },
  }
};

// --- р╕кр╕гр╕╕р╕Ыр╕Др╕│р╕кр╕▒р╣Ир╕Зр╕Лр╕╖р╣Йр╕н ---
let html = "<ul>";
let total = 0;

draft.cart.forEach(it=>{
┬а // ЁЯМЯ р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╕Бр╕▓р╕гр╕Фр╕╢р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ир╕▓р╕Б it.index р╣Ар╕Ыр╣Зр╕Щ it.menuName
┬а const item = menus[draft.shop][it.menuName];
  
  // р╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щр╕Вр╣Йр╕нр╕Ьр╕┤р╕Фр╕Юр╕ер╕▓р╕Фр╕лр╕▓р╕Бр╣Др╕бр╣Ир╕Юр╕Ър╣Ар╕бр╕Щр╕╣
  if (!item) return; 

┬а let special = it.special ? 10 : 0;
┬а let sum = (item.price + special) * it.qty;
┬а total += sum;

┬а // ЁЯМЯ р╣Гр╕Кр╣Й it.menuName р╕кр╕│р╕лр╕гр╕▒р╕Ър╣Бр╕кр╕Фр╕Зр╕Кр╕╖р╣Ир╕нр╣Ар╕бр╕Щр╕╣
┬а html += `<li>${it.menuName} x${it.qty} ${it.special ? "(р╕Юр╕┤р╣Ар╕ир╕й)" : ""} тАФ ${sum} р╕Ър╕▓р╕Ч</li>`;
});
html += "</ul>";
html += `<p><strong>р╕гр╕зр╕бр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф: ${total} р╕Ър╕▓р╕Ч</strong></p>`;

if(draft.note) html += `<p>р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕: <i>${draft.note}</i></p>`;

// р╣Бр╕кр╕Фр╕Зр╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╕Бр╕▓р╕гр╕гр╕▒р╕Ъ
let pickUpType = '';
if(draft.eatHere && draft.takeAway) {
    pickUpType = 'р╕Чр╕▓р╕Щр╕Чр╕╡р╣Ир╕гр╣Йр╕▓р╕Щ р╣Бр╕ер╕░ р╕гр╕▒р╕Ър╕Бр╕ер╕▒р╕Ър╕Ър╣Йр╕▓р╕Щ';
} else if (draft.eatHere) {
    pickUpType = 'р╕Чр╕▓р╕Щр╕Чр╕╡р╣Ир╕гр╣Йр╕▓р╕Щ';
} else if (draft.takeAway) {
    pickUpType = 'р╕гр╕▒р╕Ър╕Бр╕ер╕▒р╕Ър╕Ър╣Йр╕▓р╕Щ';
}

if(pickUpType) html += `<p>р╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╕Бр╕▓р╕гр╕гр╕▒р╕Ъ: ${pickUpType}</p>`;


document.getElementById("summaryBox").innerHTML = html;

// ----- р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╣Ар╕ер╕╖р╕нр╕Бр╣Бр╕Ър╕Ър╕Хр╕┤р╣Кр╕Б -----
function togglePay(type){
┬а if(type === 'qr'){
┬а ┬а document.getElementById('payCash').checked = false;
┬а } else {
┬а ┬а document.getElementById('payQR').checked = false;
┬а }
}

// ----- р╕Ыр╕╕р╣Ир╕бр╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Бр╕▓р╕гр╕Кр╕│р╕гр╕░ -----
function confirmPayment(){
┬а const payQR = document.getElementById('payQR').checked;
┬а const payCash = document.getElementById('payCash').checked;

┬а if(!payQR && !payCash){
┬а ┬а alert("р╕Бр╕гр╕╕р╕Ур╕▓р╣Ар╕ер╕╖р╕нр╕Бр╕зр╕┤р╕Шр╕╡р╕Кр╕│р╕гр╕░р╣Ар╕Зр╕┤р╕Щ");
┬а ┬а return;
┬а }

┬а draft.payQR = payQR;
┬а draft.payCash = payCash;
┬а localStorage.setItem('orderDraft', JSON.stringify(draft));

┬а if(payQR) location.href = "qrcode.html";
┬а else location.href = "cash.html";
}
</script>

</body>
</html>